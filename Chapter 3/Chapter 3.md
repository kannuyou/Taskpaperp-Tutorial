# 第三章：定位和过滤

当你建立了一个事无巨细的列表，随之而来的问题就是怎么找到你需要的东西。

定位和过滤是两种「寻找」的方法，其本质区别就在于一个是快速找到任务所在位置，一个则是把任务汇集在你眼前。列表从宏观入手，标签自微观切入。

和多数任务管理软件一样，TaskPaper 里的列表（项目）主要用于定位，标签则司过滤。但是它也有一个独特的设计：sidebar & Go To Anything，里面汇集了所有的标签（除了个别特意排除掉的）、列表和搜索动作。对于多数不复杂的情景，你可以不用特意去想到底该用哪种搜索方式，只要输入模糊的关键词。

> The first to know about search in TaskPaper is that you never need to think about them.（关于 TaskPaper 里的搜索，首先要知道的就是你不必想着要搜什么）——Jesse（TaskPaper 开发者）

Sidebar 和 Go To Anything 两个功能实质上是一样的，但是前者提供了更倾向光标点选的操作，后者则通过打字的方式检索，近似 spotlight 和 Alfred。

【Go To Anything 自动匹配】

Sidebar 其实也有自动匹配操作：当你用光标点一下该区域，然后任意按一个字母，就能定位到对应首字母的项，例如按一下 `T` 选中「Today」；没有该首字母的话就匹配第二个字母，依此类推；遇到字母冲突的时候，像是「Today」和「TaskPaper」都由「T」打头，则可以通过先后（间隙极端）按下 `T` 和 `0` 定位到「Today」搜索。

【Sidebar 自动匹配】

无论是 sidebar 还是 Go To Anything，包括之后会详细介绍的标签组，它们的自动匹配都只支持英文。我建议项目名、标签（组）名以及搜索动作名——总之 sidebar 里的一切，都使用英文，便于进行自动匹配。

Sideabar 在一定程度上模糊了标签、项目和搜索之间的区别，让你找任务更轻松，体验类似文本编辑器内的 `⌘command+F`。至于更精确的定位与搜索，则可以下文的方法实现。

## 通过列表快速定位

列表在 TaskPaper 相当于文件夹，与标签不同，任务和列表是函数一样一一对应的关系，任务好像菜单上的菜品，有着自己固定的位置，这就为定位提供了方便。

### 主列表、项目和任务组

TaskPaper 支持无限层级，如果你需要，可以项目里嵌套项目、项目任务互相嵌套，但基于列表的目的——**结构化文本，以便检视、快速定位**——劝君惜墨如金，够用即可，是我们能消受得起的不过三四层，再复杂下去反而不利于查找定位——就像普通用户看到 Linux 命令行内太长的路径会头疼。

项目和拥有子任务的任务组，在 TaskPaper 里都视为一种列表。由于项目存在于 sidebar，拥有更多被看见的机会。根据 sidebar 的显示方式，列表有主列表（Home）和各个列表（项目，即 Projects）之分，但是任务组则不会显示在 sidebar 里，对于定位的意义较小，这里不做讨论。

一份 taskpaper 文件里的所有内容都呈现在 Home 列表，里面包含了列表，通过缩进来分隔它们；对于项目，还会采用加粗字体的项目名，整个 Home 列表非常直观，和在纸上列出的清单一样，没有多余的修饰。其实不论你点进哪个列表，里面都是 TaskPaper 四大基本元素组成的， **切换到任何一处都保持了视觉上的干净和统一。**

【列表sketch】

一个项目看上去就是一个色块，像是俯视之下的街区建筑，井井有条、界限分明。在 TaskPaper 的设计理念中，无论这一任务管理工具增加了多少功能，始终不脱离列表这一本质。它最大限度地摒弃图形界面，降低用户学习、理解列表组织方式的成本，**依靠 sidebar 和列表本身的形状来定位。**实际上你不用过度解读各种列表的定义，只需依符合自己的直觉的方式创建列表：追求简单直观。

### 给列表「上色」

如果你觉得，在视觉上，默认的灰白配色还不能很好起到分隔作用，可以通过 StyleSheet 自定义色彩。在文件夹路径 `/Users/apple/Library/Application\ Support/TaskPaper/StyleSheets/` 下可见默认的配色文件「Light.less」。我原地复制了一份，改名换姓为 Dark。TaskPaper 使用 LESS（一门 CSS 预处理语言）文件来配色（以及其他视觉效果）。这是一个非常简单的例子，我特意把项目名设置为显眼的红色：

【配色 效果】

不需要其他任何应用，靠 TaskPaper 就可以编辑 LESS 文件，就像编辑一份任务文件一样，一行一行往里面加配色语句就可以。

【配色 编辑】

官方提供了非常丰富的可选项，我挑了对于定位最实用的几项。当然可以自定义的远远不止颜色，这里只是最简单的一次运用。

【配色 语法】

颜色可以用简单的小写英文单词，red、blue 这些常见单词可以被识别，**在冒号和颜色之间需要一个英文空格隔开**；需要更复杂的颜色，请用 rgb 或 hsl 格式的颜色表达式，例如：

```
rgb(98%,98%,98%)
hsl(187, 47%, 55%)
```

如果颜色表达起来很长，建议写成「代码块」以便自己阅读——写在一行里也不会影响执行，丰俭由人。写好后保存一下，在 TaskPaper 菜单栏的 Window-StyleSheet 里选择刚才的 Dark.less，就看到配色起作用了。

有趣的是，TaskPaper 其他配置文件同样可以打开为整齐划一的列表，如果你常常用 TaskPaper 来配置 TaskPaper，会有一种微妙的感觉；不借助其他工具就可以配置自身（体验和记录任务完全一样），这也是 TaskPaper 的简单、统一之处。对于普通用户，StyleSheet 他可以不用，但是某一天心血来潮或意识到需求之时，可以没太大台阶就上手。

### 层级

各种列表依靠层级来组织，所谓同一层就是一行内容前的空格一样多——看起来靠左对齐；任务或项目越靠左层级越高。修改层级在 TaskPaper 里很简单。我们可以简单地用 `⇥tab` 和 `⇧shift+⇥tab` 将某一行往后/往前移动一层，也可以用 `⌃control+⌘command+方向键` 把它往前后、上下移动。

【层级移动】

批量操作也是一样的快捷键，如果没有批量选中，层级操作只会针对当前行，改变项目的层级并不会影响下面的任务。但你把某一个项目或任务组折叠起来的话，移动又是整组进行的了。

### 聚焦

除了直接在 sidebar 或 Go To Anything 里定位，你也可以用聚焦快捷键展开显示某个项目或任务组。所谓聚焦，是基于列表的一种定位方式，通俗讲就是只看某一个列表，把其他内容都隐藏起来。Sidebar 和 Go To Anything 也是一种聚焦，它们像是使用；而使用快捷键的话，则是像放大镜一样，展开当前的列表、排除其他的列表。

【聚焦】

聚焦的快捷键是 `⌥option+⌘command+←/→`。当你扫视整个列表的时候，恰好遇到某个想仔细看看的项目，用 `⌥option+⌘command+→` 聚焦到它身上一准没错。

## 标签和搜索

标签并不是一个高深的概念，我们早在不知道什么是任务管理的时候，就已经在这么做使用它们了。笔记簿里的书签、大部头参考书侧面的索引，都是一种标签。

【参考书】

但是物理世界中的标签作用有限，只能指示一个特定的位置，而智能设备上的应用则把标签提升了一个等级，获得了过滤的作用。我们不仅仅满足于知道任务在哪，更需要的是把它们汇集在眼前，这是纸笔无法满足的——即使是灵活的活页本+便利贴组合，也是以「张」为单位存储笔记，应用则可以做到字符级别。

使用 TaskPaper 的初期，我时常回想起 workflowy，它们乍一看是非常相似的。在后者的官方说明里，这也是个做任务管理的软件（其实用户往往把它当做大纲工具）。

【TaskPaper 和 workflowy】

但是我觉得二者的属性完全不同：

- TaskPaper 基于本地的文档，workflowy 的数据主要在云端；
- TaskPaper 拥有真正的过滤（搜索语法）

第一点随着上半年 workflowy 桌面端拥有了正儿八经的窗口（以前是个极度依赖网络的菜单栏「插件」），慢慢被用户淡忘了；但第二点，则是包括 workflowy 在内众多应用无法逾越的高峰（也是 Outliner 应用和真正的任务管理应用间的分水岭）。

### 标签组

TaskPaper 的搜索之所以强大，在于其合理的标签系统，使用搜索离不开标签和标签组。这个「高级货」的公式其实非常简练：

```
@tag(value)
```

这就引入了标签组的概念（有编程经验的读者可以用「类」来理解）。TaskPaper 非常依赖标签进行搜索，用的时间长了，容易积累大量标签（包括了意义重叠、相近的标签），此时你可能绞尽脑汁回忆标签是什么——这就本末倒置。TaskPaper 的解决方案是用标签组来组织标签，把相关的一类标签统一起来管理。当然，标签组不是必须的，像 TaskPaper 预设的 `@done` 默认就没有设值。在你需要的时候设置它，而不必追求形式。

我使用较为频繁的有 `@Anki()` 标签组，括号里填入不同的学科（课目）。Anki 是一个记忆辅助 App，我拿它来背日语单词、法条和算法例子；它自带的提醒食之无味，我干脆就把 Daily 学习计划整合进了 TaskPaper。一览当天学习目标的时候，我只需要输入 `@Anki`，所以的课目都会出现；开始学习时，则键入`@Anki=刑侦学`这样的语句，只显示目前要背的几章。

【@Anki 标签】

### 搜索（过滤）语法

TaskPaper 支持两种模式的搜索：普通的搜索和 searchbar，但是只有后一种是我们要重点关注的过滤。像大多数编辑器、任务管理工具一样，在 TaskPaper 里按下 `⌘command+F` 快捷键可以打开一个搜索界面，但是这个普通搜索只能进行「找」和「替换」操作，在任务列表中高亮显示关键词。如其名字所示，不过是「Find」。这和其他文本编辑器一样是个规规矩矩的基础功能，只在于批量修改文字的时候有用。

【普通搜索】

**对于任务管理，我们需要的搜索其实是「过滤」，不仅仅是找到，还要把符合条件的任务汇集、展示给我们。**按两次快捷键 `⌘command++⇧shift+F` 打开 searchbar，进行更灵活的搜索——过滤。搜索的语法一眼看去复杂而精细：

```
@<attribute><relation><modifier><search term>

例如：

@due<=[d]next Monday
```

先放松，不用每次都输入这几项，有时缺省一部分是没事的，你也可以直接输入关键词而不管任何语法。我解释一下它们各代表了什么。

#### Attribute

Attribute 是你要搜索的属性，比如标签（组）名，作用是把搜索范围框定在一个区间。TaskPaper 内置的 attribute 有三个：

* `@type`：匹配类型，有 project、task 和 note
* `@text`：匹配一行字符，没有 attribute 的时候默认是它
* `@id`：匹配特殊的 ID（一般用不到）

使用时候的「标准」格式是这样的：

```
@type = project
```

我也不喜欢那么长一串。TaskPaper 为 `@type` 标签设置了缩写的搜索语法：

```
project AAA 即是 @project = AAA
task AAA 即是 @task = AAA
note AAA 即是 @note = AAA
```

是不是就简单多了。

#### Search term

Search term 很好理解，是你的关键词。其实一些简单的搜索，比如临时想找一下带有「庄严」的任务，直接搜「庄严」就可以。但你也发现了问题——如果有一个项目叫「投好庄严一票」（它显然不是我们需要的），却也会出现在搜索结果里。之前介绍的 `@type` 就派上用场了，配合这一限制条件，可以把结果缩小在任务内，不包括项目。

#### Relation

Relation 代表 attribute 和 search term 之间的关系，有逻辑关系、大小关系、字符匹配等几类。

【Relation图表】

留心字符相关的 relation 符号，它们是第三人称单数格式，特别是 matches 以 es 结尾，容易疏忽。

#### Modifier

你可以在 Relation 后面加上 Modifier（修饰词），让搜索结果更精确。TaskPaper 支持的修饰词如下表：

【isnd图表】

默认情况下 TaskPaper 忽略大小写，如果你需要分辨它们，请加上 `[s]`。用得最频繁的要属 `[d]`，大量以日期为条件进行的过滤都需要它。

### 组合使用

很多情况下我们要搜索的东西一句话描述不完，往往需要几句话组合在一起才能奏效。我们可以用一些词语把多个搜索语句条件起来。

【逻辑图表】

特别需要留意的是，没有~~「A and B」~~这样的语法，`A union B` 才是满足 A 或 B 条件任务的合集。还是预设搜索动作里那个经典的例子：

```
@today union @due <[d] tomorrow
```

前半部分匹配你手动打上「今天」标签的行（包括项目和任务），后面则是绝对时间符合「今天」的行。组合在一起，才是完整意义上的「今日任务」。

【today searches】

其他的组合搜索，也如法炮制。

### 搜索里的路径

**当你在 sidebar 里定位到某个列表后，如果不指定在哪个列表进行搜索，结果则只限于当前列表。**

其实，列表可以写成路径的格式，并用于搜索语句。当你需要排除某个路径，或涉及多个并列路径，可以指定具体的路径而不是使用关键词搜索。有时我搜索 `@Anki` 找背单词的任务，但是今天不想看见法律相关的内容，那就使用：

```
(@Anki) except Law//*
```

`Law//*` 表示 Law 项目下的所有项目，此时它们就和我无缘了。当然，从结果上看 `Project Law` 和路径也是一样的，但是此时用路径更简短。此外，如果 Law 下面还有「民法」「刑法」「法医学」，那么只需要输入 `民法//*` 就匹配了整个子项目，也不复杂。

路径在许多情况下可以减少输入量，但它不是必须的；如果你对于各个项目层级关系了如指掌，尽管使用更简短的路径；但是普通用户，我觉得使用关键词搜索就可以。TaskPaper 的路径使用 XPath 格式，这又是一个很棒的格式——和  ISO 8601 的时间日期格式一样具有通用性，可以在导出的时候提供更好的兼容。

学不学、用不用 XPath，如果你认为自己搜索很顺手，就不必学。TaskPaper 本质是个灵活的文字编辑器，条条大路通罗马。

### searches 搜索动作

用户不禁要抱怨：每次都得输入一串字符，很难记住，输入量也不轻。TaskPaper 考虑到了这一窘况，在 sidebar 里增加了 searches 栏目，用于保存常用的搜索动作。预设的两个 searches 是 `Today` 和 `Not Done`，点一下即可。如本章开头介绍的，searches 和 Go To Anything 里都可以选中一个搜索名进行搜索。

你也可以自定义这一部分，把常用的搜索动作保存在里面。有两个方法可以做到这一点。最简单的是点击「菜单栏-View-New Sidebar Search」，在「Label」内填入喜欢的搜索名，「Search」里则是准确的搜索条件。

例如我不满足 TaskPaper 预设时间过滤，需要添加一个过滤明天任务的 searches：`@due >=[d] tomorrow union @due <=[d] tomorrow+24h`（注意是 union 而不是 and），它表示过滤从今天午夜开始到后天凌晨之间的任务；再为这个 searches 取个名字「Tomorrow」，以上方代码框内的格式添进配置里。以此类推，再往里面增加注诸如「A head of time（提前完成）」、「This Week」之类的 searches。已经添加到 sidebar 内的 searches 也可以右键之进行修改。

【New Sidebar Search】

如果你有了比较系统化的管理方式，需要批量添加一系列的搜索条件，可以直接修改 `/Users/apple/Library/Application\ Support/TaskPaper/Configurations/searches.taskpaper` 目录下的 searches 配置文件，在最后一行下面添加自己的 searches

```
搜索名 @search(搜索条件)
```

通过直接修改配置文件的方法，你可以同时录入多条 searches。每输入一条请换行、按 tab 缩进。

【searches 配置文件】

### 补充包：习惯上的注意

TaskPaper 的标签灵活好用，但是不够「好看」，存在着三个「瑕疵」。

首先，TaskPaper 的标签只管自己所在的那一行，项目和母任务的标签不会影响到其下面的任务，项目和任务亲如父子，谈到标签却只有「各扫门前雪」。其实，这样的好处是可以减少过滤结果，只显示匹配的那一行，而不会把它下面附带的任务和子任务一股脑倒出来。如果你真的需要批量添加标签，尤其是给项目里的所有任务都贴上标签，可以全选它们，使用「cmd+t」进行打标签操作。

然后是标签组，TaskPaper 重视了搜索，却在一定程度上忽视了显示。sidebar 里只有标签组名而没有完整的 `@tag(value)` 标签名，不可以像项目-子项目那样以层级的显示。作为全键盘用户我可以理解这种设计，因为使用 searchbar 搜索的时候是不需要点按 sidebar 的，没有必要用一层层的标签占满侧边栏。所以，如果你很依赖有层级的标签，还是需要多多掌握搜索语法。

最后是有效标签的显示，这算是 TaskPaper 的不足之处。我有七八个项目，但一次只会查看一个（往往是「当日任务」这种），但是所有标签都会出现在 sidebar 和 Go To Anything 建议里；如果我把所有项目公私不分地堆在一个 taskpaper 文件里，很可能在检视课程和工作目标的时候，看见了来自「古都最好吃 100 家夜宵」的美食标签。**解决方法很简单，如果标签实在太多，或者把几个不同项目的标签堆在一起显得很违和，可以把项目分储在几个不同的 taskpaper 文件里。**同样是非常依赖的标签的 Thing 3，在处理有效标签的时候就比较讨巧，只显示当前所查看项目具有的标签，闲的清爽一些。

但是仔细想想，在这些略微的不便背后，其实正是 TaskPaper 定位和搜索的哲学：不必多想。表现在 sidebar 上，就是用不着一层一层往下翻找，简单的（现成的）瞥一眼直接点，没有就打开 searchbar 直接搜。

> don‘t make me think.

TaskPaper 就是那么简单直接。

### 附带条件的任务

做任务管理，重要的目的就是进行可行性判断，任务的前提事实上非常关键，有时它直接决定了是否执行一件事。我要突然抛出一个问题：任务管理的作用是什么——防止遗忘、保持……搞定……这些没错，但这些目标不是任务管理工具能直接带给你的；**任务管理的直接作用，是做判断、做规划，哪些任务能做、何时何地能做。**

其实 GTD 里的执行也不是真正去做事情，而是做之前那一刻再做一次可行性判断：

> 每一个行动决策都是凭直觉作出的。问题在于，如何从希望这个选择是正确的过渡到对它的正确性深信不疑。——David Allen《Getting Things Done》

任务管理帮助我们做出合理的判断。从做判断的角度看，我们给任务打上的标签，相当一部分是虚拟时态，是一个假设，比如 `@Chap` 就可以理解为「如果 Chap 先生在，这个任务才能执行」。

我喜欢使用这组标签 `@if()`，括弧内填入任务条件。作为一个无视时差、独来独往的人，对我来说最影响任务可行性的因素就是天气，所以没有设置 if 条件的具体类型，默认括号里就填天气了。在我写这一章的前夜，晾袜子时不慎将其抖到窗外，我不假思索地（习惯 TaskPaper 了）记下了一条任务：

```
- 捡袜子 @if(sun)
```

大意就是明天天晴的话，（出门顺路）就把袜子捡回来。这是十元三双的地摊货，衣柜里还有十几双同款的，不必担心配不成对；蜗居高层的我特意跑一趟，需要至少 15min，性价比不大。如果天晴，袜子没被打湿，那顺路一捡也不错；一旦下雨打湿，我只好放弃它了。

光从这一条来看，似乎设置条件的意义不大；但是有个三五条不确定任务时，就很有必要了。

【条件任务】

生活在天气变化无常的亚热带，下雨和晴天基本决定了出门的频率。比如九月底的某一天，当地连续下了五日雨，我攒了一堆要外出处理的事情；运气好能够放晴的话，我就去图书馆借《睡鼠说》（没有合适的电子版）、去自提柜取邮包，再把前几日拖欠的短视频取景任务完成了；如果还是下雨，就待在屋子里，烘烘衣服、补补美剧。录入这些任务的时候是不需要考虑其可行性、先后顺序的，因为最大的干扰因素「天气」尚不清楚——对于不确定的任务，务必记下，日后过滤。早起之后我看一眼天气，可以依据真实情况，过滤出当日能执行的任务。事先已经把两种天气下的任务都考虑进去，就不太会遗漏。

读者想必会问：为什么不直接使用 `sun` 和 `rain`，那样可以大大节约输入与搜索的时间。我们回忆一下标签组的意义，其实 `@if()` 并不是形式主义，**它本身就表示这个任务可能需要执行也可能无法执行，我需要用 `@if` 过滤出那些待定任务**。另一方面，除了晴雨，我也会遭遇其他情况：在北边防线自驾时曾被草原狂风追着跑，`@if(wind!)` 标签应运而出；南方的故地两年没飘过雪，`@if(snow)` 就成了一系列冬日摄影计划的最大前提。如果我把每种天气都直接设为标签，即使全屏显示 TaskPaper，sidebar 也不够用。

### 优先级

iPhone 自带的提醒事项可以设置优先级，我过去热衷于画上一个个红色惊叹号，仿佛自己很「商务」，很「有效率」。现在看来这有些自欺欺人，仿佛得了甲亢。但不可否认，优先级是一种醒目的提示。

TaskPaper 没有自带优先级，但它的标签系统能实现后者。一个操作简单、效果直观的方法是使用 emoji 表情 ‼️。**单独的 emoji 是不能被搜索到的**，我们需要把它作为优先级属性的具体值，形成这样的一系列标签：

```
@p(!)
@p(❗️)
@p(‼️)
```

如果你对视觉样式的要求比较高，觉得打括号不过雅致，可以回忆一下 StyleSheet 的基本语法。只需要把`@p1`这个标签设成红色就解决问题：

【优先级】

优先级标签会乖乖出现在 sidebar 里，可直接作为一个过滤条件使用。我坚持「今日事，今日毕」的原则，一般只使用最高一级的优先级标签，不喜欢次级的任务也来抢镜头；而你可能更希望列表整整齐齐，任务呈一二三梯队排好，你我的不同需求这一套标签都能满足。

TaskPaper 不能直接搜索 emoji 的确可惜，第一次手动输入稍微麻烦了些，之后依靠自动补全能省力点。

### 四象限

在优先级的基础上，再引入一组标签，就可以用 TaskPaper 实现四象限法，对任务进行先后轻重的分类。

【四象限】

我认为的「紧急」就是「今天就得完成的任务」，你可能有不同理解，可以根据自己的需要修改这个表格。四象限法的搜索语句无非四句话，稳定不变，非常适合存到 searchbar 里。

***

关于 XPath 语法：[XPath wiki](https://en.wikipedia.org/wiki/XPath)
